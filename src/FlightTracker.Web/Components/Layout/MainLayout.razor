@inherits LayoutComponentBase
@using FlightTracker.Web.Services
@inject VersionService VersionService

<div class="page">
    <div class="sidebar">
        <NavMenu />
    </div>

    <main>
        <div class="top-row px-4">
            <a href="https://learn.microsoft.com/aspnet/core/" target="_blank">About</a>
        </div>

        <article class="content px-4">
            @Body
        </article>
        
        <footer class="version-footer">
            <span class="version-badge" title="@GetVersionTitle()">
                v: @VersionService.GetShortCommit()
            </span>
        </footer>
    </main>
</div>

<div id="blazor-error-ui">
    An unhandled error has occurred.
    <a href="" class="reload">Reload</a>
    <a class="dismiss">ðŸ—™</a>
</div>

@code {
    private string GetVersionTitle()
    {
        var version = VersionService.GetVersion();
        return $"Commit: {version.Commit}\nBuild: {version.BuildTime}\nEnv: {version.Environment}";
    }
}

<style>
    .version-footer {
        position: fixed;
        bottom: 10px;
        right: 15px;
        z-index: 1000;
    }

    .version-badge {
        background: rgba(0, 0, 0, 0.6);
        color: #aaa;
        padding: 4px 10px;
        border-radius: 4px;
        font-size: 0.75rem;
        font-family: 'Consolas', 'Monaco', monospace;
        cursor: help;
    }

    .version-badge:hover {
        background: rgba(0, 0, 0, 0.8);
        color: #fff;
    }
</style>
